---
import { app } from "../firebase/server";
import { getAuth } from "firebase-admin/auth";
import Layout from "../layouts/Layout.astro";
import Tableau from "../components/Tableau.astro";

const auth = getAuth(app);

if (!Astro.cookies.has("__session")) {
  return Astro.redirect("/signin");
}
const sessionCookie = Astro.cookies.get("__session").value;
const decodedCookie = await auth.verifySessionCookie(sessionCookie);
const user = await auth.getUser(decodedCookie.uid);

if (!user) {
  return Astro.redirect("/signin");
}

const pageTitle = "Accueil | VulpiZ";
---

<Layout pageTitle={pageTitle}>
	<div class = "content">
		<!--<h1>Bienvenue {user.displayName}</h1>-->
  		<p>Nous sommes heureux de te voir ici</p>
		<form action="/api/auth/signout">
			<button type="submit">DÃ©connexion</button>
		</form>
		<!--<Tableau />
		<div>
			<div class="Mode">
				<fleche>
				<h1>Solo</h1>
				<fleche>
			</div>
			<bouton jouer>
			<bouton proposer question>
		</div>
		<Tableau />
	-->
	</div>
</Layout>